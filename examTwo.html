<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <title>Document</title>
  </head>
  <body>
    <div id="app">
      <div class="container mt-5">
        <div class="row">
          <div class="col-md-6 com-12">
            <div class="table">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th class="text-center" scope="col">#</th>
                    <th class="text-center" scope="col">name Item</th>
                    <th class="text-center" scope="col">chance</th>
                    <th class="text-center" scope="col">stock</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="(item,index) in storeItem" :key="index">
                    <td class="text-center">{{index+1}}</td>
                    <td class="text-center">{{item.name}}</td>
                    <td class="text-center">{{item.chance *100}} %</td>
                    <td class="text-center">{{item.stock}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="col-md-6 com-12">
            <div>
              <div class="fw-bold mb-2">
                เหลือจำนวน {{randomLimit}} ครั้ง Item
              </div>
              <button
                @click="randomItem"
                class="btn btn-success"
                style="width: 150px"
              >
                สุ่ม 1 ครั้ง
              </button>
              <button
                @click="randomMultiple(10)"
                class="btn btn-success"
                style="width: 150px"
              >
                สุ่ม 10 ครั้ง
              </button>
              <button
                @click="randomMultiple(100)"
                class="btn btn-success"
                style="width: 150px"
              >
                สุ่ม 100 ครั้ง
              </button>
            </div>
            <div class="mt-4" style="overflow: auto; max-height: 450px">
              <div
                class="fw-bold"
                v-for="(item,index) in getItemStore "
                :key="index"
              >
                {{ (getItemStore.length-index)+'. '+ item }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const vm = new Vue({
        el: "#app",
        data: function () {
          return {
            name: "PlayerOne",
            randomLimit: 100,
            getItemStore: [],
            storeItem: [
              { name: "Small Potion Heal", chance: 0.12, stock: 1000 },
              { name: "Medium Potion Heal", chance: 0.08, stock: 80 },
              { name: "Big Potion Heal", chance: 0.06, stock: 15 },
              { name: "Full Potion Heal", chance: 0.04, stock: 10 },
              { name: "Small MP Potion", chance: 0.12, stock: 1000 },
              { name: "Medium MP Potion", chance: 0.08, stock: 80 },
              { name: "Big MP Potion", chance: 0.06, stock: 15 },
              { name: "Full MP Potion", chance: 0.04, stock: 8 },
              { name: "Attack Ring", chance: 0.05, stock: 10 },
              { name: "Defense Ring", chance: 0.05, stock: 10 },
              { name: "Lucky Key", chance: 0.15, stock: 1000 },
              { name: "Silver Key", chance: 0.15, stock: 1000 }
            ]
          };
        },
        methods: {
          rangRandom(numberRandom) {
            // this.storeItem[0].stock = this.storeItem[0].stock - 1;
            // return;
            // console.log(numberRandom, "numberRandom");
            if (numberRandom > 0 && numberRandom <= 12) {
              if (this.storeItem[0].stock > 0) {
                this.storeItem[0].stock = this.storeItem[0].stock - 1;
                this.getItemStore.unshift(this.storeItem[0].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 13 && numberRandom <= 20) {
              if (this.storeItem[1].stock > 0) {
                this.storeItem[1].stock = this.storeItem[1].stock - 1;
                this.getItemStore.unshift(this.storeItem[1].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 21 && numberRandom <= 26) {
              if (this.storeItem[2].stock > 0) {
                this.storeItem[2].stock = this.storeItem[2].stock - 1;
                this.getItemStore.unshift(this.storeItem[2].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 27 && numberRandom <= 30) {
              if (this.storeItem[3].stock > 0) {
                this.storeItem[3].stock = this.storeItem[3].stock - 1;
                this.getItemStore.unshift(this.storeItem[3].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 31 && numberRandom <= 42) {
              if (this.storeItem[4].stock > 0) {
                this.storeItem[4].stock = this.storeItem[4].stock - 1;
                this.getItemStore.unshift(this.storeItem[4].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 43 && numberRandom <= 50) {
              if (this.storeItem[5].stock > 0) {
                this.storeItem[5].stock = this.storeItem[5].stock - 1;
                this.getItemStore.unshift(this.storeItem[5].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 51 && numberRandom <= 56) {
              if (this.storeItem[6].stock > 0) {
                this.storeItem[6].stock = this.storeItem[6].stock - 1;
                this.getItemStore.unshift(this.storeItem[6].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 57 && numberRandom <= 60) {
              if (this.storeItem[7].stock > 0) {
                this.storeItem[7].stock = this.storeItem[7].stock - 1;
                this.getItemStore.unshift(this.storeItem[7].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 61 && numberRandom <= 65) {
              if (this.storeItem[8].stock > 0) {
                this.storeItem[8].stock = this.storeItem[8].stock - 1;
                this.getItemStore.unshift(this.storeItem[8].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 66 && numberRandom <= 70) {
              if (this.storeItem[9].stock > 0) {
                this.storeItem[9].stock = this.storeItem[9].stock - 1;
                this.getItemStore.unshift(this.storeItem[9].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 71 && numberRandom <= 85) {
              if (this.storeItem[10].stock > 0) {
                this.storeItem[10].stock = this.storeItem[10].stock - 1;
                this.getItemStore.unshift(this.storeItem[10].name);
                this.randomLimit--;
                return;
              } else {
                this.randomItem();
              }
            } else if (numberRandom >= 86 && numberRandom <= 100) {
              if (this.storeItem[11].stock > 0) {
                this.storeItem[11].stock = this.storeItem[11].stock - 1;
                this.getItemStore.unshift(this.storeItem[11].name);
                this.randomLimit--;
              } else {
                this.randomItem();
              }
            }
          },
          randomItem() {
            let findItem = this.storeItem.find((value) => {
              return value.stock > 0;
            });
            if (findItem === undefined) return;
            if (this.randomLimit === 0) return;
            const ranDom = Math.floor(Math.random() * 100) + 1;
            this.rangRandom(ranDom);
          },
          randomMultiple(number_round = 10) {
            for (let x = 0; x < number_round; x++) {
              this.randomItem();
            }
          }
        },
        computed: {},
        watch: {},
        conponents: {},
        created() {},
        activated() {},
        mounted() {
          let landom = (Math.random() * 100).toFixed(2);
          let percenSuccess = 0;
          this.storeItem.forEach((value) => {
            percenSuccess += parseFloat(value.chance.toFixed(2));
          });
        }
      });
    </script>
  </body>
</html>
